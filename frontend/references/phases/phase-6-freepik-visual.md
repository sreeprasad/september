# Phase 6: Freepik Visual One-Pager

**Duration:** ~30 minutes
**Priority:** Medium (Polish feature)
**Judge Focus:** All judges (Professional output), AWS judges (Complete product)

---

## Overview

Freepik generates the visual one-pager PDF—a shareable, professional briefing document. This transforms the dashboard data into something you can send to yourself or colleagues before any meeting.

## Tool Information

### What is Freepik API?

- **AI-powered image generation** from text prompts
- **Multiple AI models** - Imagen, Flux, Mystic
- **High-resolution outputs** with built-in upscaling
- **Production-ready API** for developers

### Key Features

- Text-to-image generation with multiple models
- HD image creation with Magnific upscaling
- Background removal and filters
- Bulk generation via workflows
- Template-based design generation

### Resources

- **API Documentation**: https://www.freepik.com/api/image-generation
- **Mystic API Reference**: https://docs.freepik.com/api-reference/mystic/post-mystic
- **Main Site**: https://www.freepik.com/api

### Pricing

- Premium: $24/month (unlimited generations)
- Pay-as-you-go API pricing available

---

## Implementation Steps

### Step 6.1: API Setup

```bash
# No SDK install needed - REST API
# Get API key from freepik.com/api
```

**Configuration:**
```python
# config/freepik_config.py
import os

FREEPIK_CONFIG = {
    "api_key": os.getenv("FREEPIK_API_KEY"),
    "base_url": "https://api.freepik.com/v1",
    "default_model": "mystic",  # High-res with natural lighting
    "output_format": "png",
    "resolution": "1024x1024"
}
```

### Step 6.2: One-Pager Template Design

**Visual Layout:**
```
┌─────────────────────────────────────────────────────────────┐
│                     MEETING BRIEFING                        │
│                    [Person's Name]                          │
│                  Generated by Brief Me                      │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────┐                                               │
│  │  Photo   │    [Name]                                     │
│  │  (AI     │    [Role] at [Company]                        │
│  │ enhanced)│    [Professional Identity]                     │
│  └──────────┘                                               │
├─────────────────────────────────────────────────────────────┤
│  WHAT THEY CARE ABOUT                                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [Theme 1] ████████████ 45%                          │   │
│  │ [Theme 2] ███████ 30%                               │   │
│  │ [Theme 3] ████ 15%                                  │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│  TALKING POINTS                                             │
│  1. [Topic] - [Brief context]                               │
│  2. [Topic] - [Brief context]                               │
│  3. [Topic] - [Brief context]                               │
├─────────────────────────────────────────────────────────────┤
│  QUICK FACTS                                                │
│  • Company: [Recent news/funding]                           │
│  • Style: [Communication preference]                        │
│  • Avoid: [Topics to skip]                                  │
├─────────────────────────────────────────────────────────────┤
│  [QR Code to full dashboard]    Generated: [Date/Time]      │
└─────────────────────────────────────────────────────────────┘
```

### Step 6.3: PDF Generator

```python
# visual/pdf_generator.py
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
from reportlab.lib.colors import HexColor
import requests

class BriefingPDFGenerator:
    """
    Generate professional PDF one-pager from briefing data.
    """

    def __init__(self, freepik_client):
        self.freepik = freepik_client
        self.page_width = 612  # Letter size
        self.page_height = 792

    async def generate(self, briefing_data: dict) -> bytes:
        """
        Generate PDF briefing one-pager.

        Steps:
        1. Enhance profile photo with Freepik (optional)
        2. Create PDF layout
        3. Populate with briefing data
        4. Add visual elements (charts, icons)
        5. Return PDF bytes
        """

        # Create canvas
        pdf_buffer = io.BytesIO()
        c = canvas.Canvas(pdf_buffer, pagesize=letter)

        # Add header
        self._add_header(c, briefing_data)

        # Add profile section
        self._add_profile_section(c, briefing_data)

        # Add themes visualization
        self._add_themes_section(c, briefing_data)

        # Add talking points
        self._add_talking_points(c, briefing_data)

        # Add quick facts
        self._add_quick_facts(c, briefing_data)

        # Add footer
        self._add_footer(c, briefing_data)

        c.save()
        return pdf_buffer.getvalue()

    def _add_header(self, canvas, data):
        """Add branded header."""
        canvas.setFillColor(HexColor("#4F46E5"))
        canvas.rect(0, 740, 612, 52, fill=True, stroke=False)
        canvas.setFillColor(HexColor("#FFFFFF"))
        canvas.setFont("Helvetica-Bold", 24)
        canvas.drawCentredString(306, 760, "MEETING BRIEFING")
        canvas.setFont("Helvetica", 14)
        canvas.drawCentredString(306, 745, data['person']['name'])

    def _add_themes_section(self, canvas, data):
        """Add theme visualization bars."""
        themes = data['themes']['frequency_breakdown']
        y_position = 500

        for theme, percentage in themes.items():
            # Draw label
            canvas.setFillColor(HexColor("#333333"))
            canvas.drawString(50, y_position, theme)

            # Draw bar
            bar_width = percentage * 300  # Scale to max 300px
            canvas.setFillColor(HexColor("#4F46E5"))
            canvas.rect(150, y_position - 5, bar_width, 15, fill=True)

            # Draw percentage
            canvas.setFillColor(HexColor("#666666"))
            canvas.drawString(460, y_position, f"{int(percentage * 100)}%")

            y_position -= 25
```

### Step 6.4: Freepik Image Enhancement

```python
# visual/image_enhancer.py
import aiohttp

class FreepikImageEnhancer:
    """
    Use Freepik API for visual enhancements.
    """

    async def enhance_profile_image(self, image_url: str) -> str:
        """
        Enhance profile image quality using Freepik.

        Options:
        - Upscale with Magnific
        - Background enhancement
        - Style consistency
        """
        pass

    async def generate_theme_icons(self, themes: list) -> dict:
        """
        Generate custom icons for each theme.

        Use Freepik's text-to-image to create
        consistent iconography for the one-pager.
        """

        icons = {}

        for theme in themes:
            prompt = f"Minimalist professional icon representing {theme}, blue color scheme, white background, simple clean design"

            response = await self._generate_image(prompt)
            icons[theme] = response['image_url']

        return icons

    async def _generate_image(self, prompt: str) -> dict:
        """
        Call Freepik Mystic API for image generation.
        """

        async with aiohttp.ClientSession() as session:
            headers = {
                "Authorization": f"Bearer {self.api_key}",
                "Content-Type": "application/json"
            }

            payload = {
                "prompt": prompt,
                "model": "mystic",
                "width": 512,
                "height": 512,
                "num_images": 1
            }

            async with session.post(
                "https://api.freepik.com/v1/mystic",
                headers=headers,
                json=payload
            ) as response:
                return await response.json()
```

### Step 6.5: Alternative: HTML-to-PDF Approach

If Freepik integration is time-constrained, use HTML-to-PDF:

```python
# visual/html_pdf_generator.py
from weasyprint import HTML
import jinja2

class HTMLPDFGenerator:
    """
    Generate PDF from HTML template.
    Faster to implement, still professional output.
    """

    def __init__(self):
        self.template_env = jinja2.Environment(
            loader=jinja2.FileSystemLoader('templates/')
        )

    async def generate(self, briefing_data: dict) -> bytes:
        """
        Generate PDF from HTML template.
        """

        template = self.template_env.get_template('briefing.html')
        html_content = template.render(**briefing_data)

        pdf = HTML(string=html_content).write_pdf()
        return pdf
```

**HTML Template:**
```html
<!-- templates/briefing.html -->
<!DOCTYPE html>
<html>
<head>
    <style>
        @page { size: letter; margin: 0.5in; }
        body { font-family: 'Inter', sans-serif; }
        .header { background: #4F46E5; color: white; padding: 20px; text-align: center; }
        .profile { display: flex; gap: 20px; margin: 20px 0; }
        .theme-bar { height: 20px; background: #4F46E5; border-radius: 4px; }
        .talking-point { padding: 10px; border-left: 3px solid #4F46E5; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Meeting Briefing</h1>
        <h2>{{ person.name }}</h2>
    </div>

    <div class="profile">
        <img src="{{ person.photo_url }}" width="100" />
        <div>
            <h3>{{ person.name }}</h3>
            <p>{{ person.role }} at {{ person.company }}</p>
            <p><em>{{ person.professional_identity }}</em></p>
        </div>
    </div>

    <h3>What They Care About</h3>
    {% for theme, percentage in themes.frequency_breakdown.items() %}
    <div>
        <span>{{ theme }}</span>
        <div class="theme-bar" style="width: {{ percentage * 100 }}%"></div>
        <span>{{ (percentage * 100)|int }}%</span>
    </div>
    {% endfor %}

    <h3>Talking Points</h3>
    {% for point in talking_points %}
    <div class="talking-point">
        <strong>{{ point.point }}</strong>
        <p>{{ point.context }}</p>
    </div>
    {% endfor %}

    <footer>
        Generated by Brief Me | {{ generated_at }}
    </footer>
</body>
</html>
```

---

## Data Schema

### Input (from Dashboard/Backend)
```json
{
  "person": {
    "name": "string",
    "photo_url": "string",
    "role": "string",
    "company": "string",
    "professional_identity": "string"
  },
  "themes": {
    "frequency_breakdown": {
      "topic": 0.45
    }
  },
  "talking_points": [
    {
      "point": "string",
      "context": "string"
    }
  ],
  "quick_facts": {
    "company_news": "string",
    "communication_style": "string",
    "topics_to_avoid": []
  },
  "generated_at": "ISO timestamp"
}
```

### Output
- PDF file (bytes)
- Shareable URL (if hosted)

---

## Demo Script Points

During the demo, highlight:

1. **"This is shareable"** - Show the PDF generation
2. **"Send it to yourself 5 minutes before any meeting"**
3. **Professional appearance** - Clean, branded design
4. **QR code to full dashboard** - Bridge between quick reference and deep dive

**Key Demo Moment:**
> Click "Download PDF" → Show the clean one-pager → "You can AirDrop this to yourself right before walking into the meeting."

---

## Testing Checklist

- [ ] PDF generates without errors
- [ ] All briefing data displays correctly
- [ ] Theme bars scale properly
- [ ] Layout fits on one page
- [ ] Text is readable at print size
- [ ] Download works from dashboard
- [ ] File size is reasonable (<2MB)
- [ ] Freepik enhancements work (if implemented)

---

## Files to Create

```
src/
├── visual/
│   ├── __init__.py
│   ├── pdf_generator.py
│   ├── image_enhancer.py
│   └── html_pdf_generator.py
├── templates/
│   ├── briefing.html
│   └── briefing.css
├── config/
│   └── freepik_config.py
└── assets/
    ├── logo.png
    └── icons/
```

---

## Fallback Options

If Freepik API has issues:

1. **HTML-to-PDF**: Use WeasyPrint or Puppeteer
2. **Retool PDF Export**: Native Retool export feature
3. **Screenshot-to-PDF**: Capture dashboard as image

---

## Success Criteria

1. **Professional**: Clean, branded appearance
2. **Complete**: All key information on one page
3. **Shareable**: Easy to download and send
4. **Fast**: Generation under 5 seconds
5. **Readable**: Clear typography and hierarchy
6. **Demo-ready**: Impressive visual output
