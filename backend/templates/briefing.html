<!DOCTYPE html>
<html>
<head>
    <style>
        @page { size: letter; margin: 0.5in; }
        body { font-family: 'Inter', sans-serif; font-size: 12px; }
        .header { background: #4F46E5; color: white; padding: 20px; text-align: center; }
        .profile { display: flex; gap: 20px; margin: 20px 0; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .profile-img { border-radius: 50%; width: 80px; height: 80px; background: #ddd; object-fit: cover; }
        .section { margin-bottom: 20px; }
        .section h3 { color: #4F46E5; border-bottom: 2px solid #4F46E5; padding-bottom: 5px; margin-bottom: 10px; }
        .theme-row { margin-bottom: 8px; display: flex; align-items: center; }
        .theme-label { width: 150px; font-weight: bold; }
        .theme-bar-container { flex-grow: 1; background: #eee; height: 15px; border-radius: 4px; overflow: hidden; margin: 0 10px; }
        .theme-bar { height: 100%; background: #4F46E5; }
        .talking-point { padding: 10px; background: #f9fafb; border-left: 4px solid #4F46E5; margin-bottom: 10px; }
        .talking-point strong { display: block; margin-bottom: 4px; color: #111; }
        .footer { margin-top: 30px; border-top: 1px solid #ddd; padding-top: 10px; text-align: center; color: #666; font-size: 10px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Meeting Briefing</h1>
        <h2>{{ person.name }}</h2>
    </div>

    <div class="profile">
        <!-- Placeholder image if not provided -->
        <img class="profile-img" src="{{ person.photo_url or 'https://via.placeholder.com/100' }}" />
        <div>
            <h2 style="margin: 0 0 5px 0;">{{ person.name }}</h2>
            <p style="margin: 0; font-weight: bold;">{{ person.role }} at {{ person.company }}</p>
            <p style="margin: 5px 0 0 0; font-style: italic; color: #555;">{{ person.professional_identity }}</p>
        </div>
    </div>

    <div class="section">
        <h3>What They Care About</h3>
        {% if themes and themes.frequency_breakdown %}
            {% for theme, percentage in themes.frequency_breakdown.items() %}
            <div class="theme-row">
                <span class="theme-label">{{ theme }}</span>
                <div class="theme-bar-container">
                    <div class="theme-bar" style="width: {{ percentage * 100 }}%"></div>
                </div>
                <span>{{ (percentage * 100)|int }}%</span>
            </div>
            {% endfor %}
        {% else %}
            <p>No theme data available.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Talking Points</h3>
        {% if talking_points %}
            {% for point in talking_points %}
            <div class="talking-point">
                <strong>{{ point.point }}</strong>
                <span>{{ point.context }}</span>
            </div>
            {% endfor %}
        {% else %}
            <p>No talking points generated.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Quick Facts</h3>
        <ul>
            {% if company_context %}
                <li><strong>Company:</strong> {{ company_context.name }}</li>
                {% if company_context.recent_developments %}
                    <li><strong>News:</strong> {{ company_context.recent_developments[0] if company_context.recent_developments else 'N/A' }}</li>
                {% endif %}
            {% endif %}
            {% if sentiment %}
                <li><strong>Style:</strong> {{ sentiment.communication_style }}</li>
            {% endif %}
        </ul>
    </div>

    <div class="footer">
        Generated by Brief Me | {{ generated_at }}
    </div>
</body>
</html>
